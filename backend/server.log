🚀 正在启动任务管理系统后端服务...
📊 初始化数据库...
🚀 开始初始化数据库...
✅ 数据库 task_manager_db 已确保存在
🔗 创建数据库连接池，目标数据库: task_manager_db
✅ 数据库连接成功
📋 创建数据库表结构...
   创建表: students
   创建表: student_profiles
   创建表: tasks
   创建表: leave_records
   创建表: system_config
✅ 数据库表结构创建成功
📝 插入初始数据...
✅ 初始数据已存在，跳过插入
👁️ 创建数据库视图...
✅ 数据库视图创建成功
🎉 数据库初始化完成！
⏰ 初始化定时任务...
⏰ 定时任务服务已初始化（24:00任务重新调度）
🚀 定时任务已启动

🎉 任务管理系统后端启动成功！
📍 服务器运行在端口: 3001
🌍 环境: development
🔗 健康检查: http://localhost:3001/health
📚 API文档: http://localhost:3001/api

🔑 默认登录信息:
   学生ID: ST001 或 ST002
   密码: Hello888

✅ 数据库 task_manager_db 已确保存在
✅ 数据库连接成功
Token验证失败: JsonWebTokenError: jwt malformed
    at module.exports [as verify] (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/jsonwebtoken/verify.js:70:17)
    at authenticateToken (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/middleware/auth.js:43:25)
    at Layer.handle [as handle_request] (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/index.js:328:13)
    at /Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/index.js:286:9
    at router.process_params (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/index.js:346:12)
    at next (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/index.js:280:10)
    at router.handle (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/index.js:175:3)
    at router (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/index.js:47:12)
    at Layer.handle [as handle_request] (/Users/danieldong/Documents/GitHub/gougegaoshu/backend/node_modules/express/lib/router/layer.js:95:5)
🔄 学生 ST001 请求重置任务到初始状态
✅ 学生 ST001 任务重置完成，重置了 85 个任务到原始状态
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-13
📊 2025-07-13 未完成任务数量: 0
ℹ️ 2025-07-13 没有未完成任务，无需处理
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-14
📊 2025-07-14 未完成任务数量: 3
🕛 开始处理24:00任务调度: 学生=ST001, 日期=2025-07-14
📊 查询到 3 个未完成任务
  1. 容器化技术Docker (ID: ST001-2025-07-14-1752381016968-6r8cac2wo)
  2. 学术写作规范 (ID: ST001-2025-07-14-1752381016968-coonkluq1)
  3. 量子力学数学基础 (ID: ST001-2025-07-14-1752381016968-ucfb7ruo0)
⚖️ 结转阈值: 3, 当前未完成任务数: 3
🔄 执行顺延模式 (3 >= 3)
需要顺延的未来日期数量: 17
顺延 3 个任务到 2025-07-15，后续任务自动顺延
✅ 24:00任务处理完成，处理了 3 个未完成任务
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-15
📊 2025-07-15 未完成任务数量: 0
ℹ️ 2025-07-15 没有未完成任务，无需处理
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-16
📊 2025-07-16 未完成任务数量: 0
ℹ️ 2025-07-16 没有未完成任务，无需处理
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-17
📊 2025-07-17 未完成任务数量: 0
ℹ️ 2025-07-17 没有未完成任务，无需处理
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-18
📊 2025-07-18 未完成任务数量: 0
ℹ️ 2025-07-18 没有未完成任务，无需处理
🔄 学生 ST001 请求重置任务到初始状态
✅ 学生 ST001 任务重置完成，重置了 85 个任务到原始状态
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-13
📊 2025-07-13 未完成任务数量: 0
ℹ️ 2025-07-13 没有未完成任务，无需处理
🕛 学生 ST001 手动触发24:00处理，日期: 2025-07-14
📊 2025-07-14 未完成任务数量: 3
🕛 开始处理24:00任务调度: 学生=ST001, 日期=2025-07-14
📊 查询到 3 个未完成任务
  1. 容器化技术Docker (ID: ST001-2025-07-14-1752381016968-6r8cac2wo)
  2. 学术写作规范 (ID: ST001-2025-07-14-1752381016968-coonkluq1)
  3. 量子力学数学基础 (ID: ST001-2025-07-14-1752381016968-ucfb7ruo0)
⚖️ 结转阈值: 3, 当前未完成任务数: 3
🔄 执行顺延模式 (3 >= 3)
需要顺延的未来日期数量: 17
顺延 3 个任务到 2025-07-15，后续任务自动顺延
✅ 24:00任务处理完成，处理了 3 个未完成任务
🔄 学生 ST001 请求重置任务到初始状态
✅ 学生 ST001 任务重置完成，重置了 85 个任务到原始状态
收到SIGTERM信号，正在关闭服务器...
