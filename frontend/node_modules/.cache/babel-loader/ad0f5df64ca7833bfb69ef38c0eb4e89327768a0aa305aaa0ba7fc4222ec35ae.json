{"ast":null,"code":"import React,{createContext,useContext,useReducer,useEffect}from'react';import{authAPI}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AppContext=/*#__PURE__*/createContext();// ÂàùÂßãÁä∂ÊÄÅ\nconst initialDate=new Date();const savedSystemDate=localStorage.getItem('systemDate');const currentSystemDate=savedSystemDate?new Date(savedSystemDate):new Date(initialDate);const initialState={user:null,isAuthenticated:false,loading:true,error:null,systemDate:currentSystemDate,initialDate:new Date(initialDate)};// ActionÁ±ªÂûã\nconst actionTypes={SET_LOADING:'SET_LOADING',SET_USER:'SET_USER',SET_ERROR:'SET_ERROR',LOGOUT:'LOGOUT',SET_SYSTEM_DATE:'SET_SYSTEM_DATE'};// Reducer\nfunction appReducer(state,action){switch(action.type){case actionTypes.SET_LOADING:return{...state,loading:action.payload};case actionTypes.SET_USER:return{...state,user:action.payload,isAuthenticated:!!action.payload,loading:false,error:null};case actionTypes.SET_ERROR:return{...state,error:action.payload,loading:false};case actionTypes.LOGOUT:return{...state,user:null,isAuthenticated:false,loading:false};case actionTypes.SET_SYSTEM_DATE:return{...state,systemDate:action.payload};default:return state;}}// Context Provider\nexport const AppProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(appReducer,initialState);// ÂàùÂßãÂåñÊó∂Ê£ÄÊü•token\nuseEffect(()=>{const initAuth=async()=>{const token=localStorage.getItem('token');const savedUser=localStorage.getItem('user');if(token&&savedUser){try{// È™åËØÅtokenÊòØÂê¶ÊúâÊïà\nconst response=await authAPI.verify();if(response.success){dispatch({type:actionTypes.SET_USER,payload:JSON.parse(savedUser)});}else{// tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\nlocalStorage.removeItem('token');localStorage.removeItem('user');dispatch({type:actionTypes.LOGOUT});}}catch(error){console.error('TokenÈ™åËØÅÂ§±Ë¥•:',error);localStorage.removeItem('token');localStorage.removeItem('user');dispatch({type:actionTypes.LOGOUT});}}else{dispatch({type:actionTypes.SET_LOADING,payload:false});}};initAuth();},[]);// ÁôªÂΩï\nconst login=async function(studentId,password){let rememberMe=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;try{dispatch({type:actionTypes.SET_LOADING,payload:true});dispatch({type:actionTypes.SET_ERROR,payload:null});const response=await authAPI.login(studentId,password);if(response.success){const{token,student}=response.data;// ‰øùÂ≠òÂà∞localStorage\nlocalStorage.setItem('token',token);localStorage.setItem('user',JSON.stringify(student));if(rememberMe){localStorage.setItem('savedCredentials',JSON.stringify({studentId,password}));}else{localStorage.removeItem('savedCredentials');}dispatch({type:actionTypes.SET_USER,payload:student});return{success:true};}}catch(error){dispatch({type:actionTypes.SET_ERROR,payload:error.message});return{success:false,message:error.message};}};// ÁôªÂá∫\nconst logout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');dispatch({type:actionTypes.LOGOUT});};// Âº∫Âà∂‰øÆÊîπÂØÜÁ†Å\nconst forceChangePassword=async newPassword=>{try{const response=await authAPI.forceChangePassword(newPassword);if(response.success){// Êõ¥Êñ∞Áî®Êà∑Áä∂ÊÄÅ\nconst updatedUser={...state.user,forcePasswordChange:false};localStorage.setItem('user',JSON.stringify(updatedUser));dispatch({type:actionTypes.SET_USER,payload:updatedUser});return{success:true};}}catch(error){return{success:false,message:error.message};}};// ‰øÆÊîπÂØÜÁ†Å\nconst changePassword=async(oldPassword,newPassword)=>{try{const response=await authAPI.changePassword(oldPassword,newPassword);return response;}catch(error){return{success:false,message:error.message};}};// ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÁî®‰∫éÊ®°ÊãüÔºâ\nconst setSystemDate=date=>{localStorage.setItem('systemDate',date.toISOString());dispatch({type:actionTypes.SET_SYSTEM_DATE,payload:date});};// ËøõÂÖ•‰∏ã‰∏ÄÂ§©ÔºàÊ®°ÊãüÂäüËÉΩÔºâ\nconst advanceDay=async()=>{try{const currentDate=new Date(state.systemDate);const nextDay=new Date(currentDate);nextDay.setDate(nextDay.getDate()+1);console.log(`üìÖ ‰ªé ${currentDate.toLocaleDateString('zh-CN')} ÂâçËøõÂà∞ ${nextDay.toLocaleDateString('zh-CN')}`);// Âú®ÂàáÊç¢Âà∞‰∏ã‰∏ÄÂ§©‰πãÂâçÔºåÂÖàÂ§ÑÁêÜÂΩìÂ§©ÁöÑÊú™ÂÆåÊàê‰ªªÂä°\nawait processMidnightTasks(currentDate);// ËÆæÁΩÆÊñ∞Êó•Êúü\nsetSystemDate(nextDay);console.log(`‚úÖ Êó•ÊúüÂàáÊç¢ÂÆåÊàê: ${nextDay.toLocaleDateString('zh-CN')}`);}catch(error){console.error('‚ùå advanceDay Â§±Ë¥•:',error);throw error;// ÈáçÊñ∞ÊäõÂá∫ÈîôËØØÔºåËÆ©Ë∞ÉÁî®ËÄÖÁü•ÈÅìÂ§±Ë¥•‰∫Ü\n}};// ÈáçÁΩÆÂà∞ÂàùÂßãÊó•Êúü\nconst resetToInitialDate=()=>{localStorage.removeItem('systemDate');setSystemDate(new Date(state.initialDate));};// Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ËÆæÁΩÆÊó•ÊúüÔºàÂè™ËÉΩËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•ÁöÑÊó•ÊúüÔºâ\nconst canSetDate=targetDate=>{const today=new Date(state.initialDate);today.setHours(0,0,0,0);const target=new Date(targetDate);target.setHours(0,0,0,0);return target>=today;};// ÂÆâÂÖ®ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÂè™ÂÖÅËÆ∏ËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•Êó•ÊúüÔºâ\nconst setSystemDateSafely=async date=>{if(canSetDate(date)){const currentDate=new Date(state.systemDate);const targetDate=new Date(date);// Â¶ÇÊûúÊòØË∑≥Ë∑ÉÂà∞Êú™Êù•Êó•ÊúüÔºåÈúÄË¶ÅÂ§ÑÁêÜ‰∏≠Èó¥ÊâÄÊúâÊó•ÊúüÁöÑ24:00‰ªªÂä°\nif(targetDate>currentDate){let processDate=new Date(currentDate);while(processDate<targetDate){await processMidnightTasks(processDate);processDate.setDate(processDate.getDate()+1);}}setSystemDate(date);return true;}return false;};// Â§ÑÁêÜ24:00‰ªªÂä°ÔºàËá™Âä®Ë∞ÉÁî®Ôºâ\nconst processMidnightTasks=async targetDate=>{try{// Âè™ÊúâÂú®Áî®Êà∑Â∑≤ÁôªÂΩïÁöÑÊÉÖÂÜµ‰∏ãÊâçÂ§ÑÁêÜ\nif(!state.user){console.log('Áî®Êà∑Êú™ÁôªÂΩïÔºåË∑≥Ëøá24:00‰ªªÂä°Â§ÑÁêÜ');return;}const dateStr=targetDate.toISOString().split('T')[0];console.log(`üïõ Ëá™Âä®Â§ÑÁêÜ ${dateStr} ÁöÑ24:00‰ªªÂä°...`);const token=localStorage.getItem('token');if(!token){console.warn('Êú™ÊâæÂà∞ËÆ§ËØÅ‰ª§ÁâåÔºåË∑≥Ëøá24:00‰ªªÂä°Â§ÑÁêÜ');return;}const response=await fetch('/api/tasks/midnight-process',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify({date:dateStr})});if(response.ok){const result=await response.json();if(result.success){console.log(`‚úÖ 24:00‰ªªÂä°Â§ÑÁêÜÂÆåÊàê:`,result.data);}else{console.warn('‚ö†Ô∏è 24:00‰ªªÂä°Â§ÑÁêÜË≠¶Âëä:',result.message);}}else{const errorText=await response.text();console.error(`‚ùå 24:00‰ªªÂä°Â§ÑÁêÜHTTPÈîôËØØ ${response.status}:`,errorText);}}catch(error){console.error('‚ùå Ëá™Âä®24:00Â§ÑÁêÜÂ§±Ë¥•:',error);// ‰∏çÊäõÂá∫ÈîôËØØÔºåÈÅøÂÖçÂΩ±ÂìçÊó•ÊúüÂàáÊç¢\n}};const value={...state,login,logout,forceChangePassword,changePassword,setSystemDate,setSystemDateSafely,advanceDay,resetToInitialDate,canSetDate};return/*#__PURE__*/_jsx(AppContext.Provider,{value:value,children:children});};// Hook for using context\nexport const useApp=()=>{const context=useContext(AppContext);if(!context){throw new Error('useApp must be used within an AppProvider');}return context;};export default AppContext;","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authAPI","jsx","_jsx","AppContext","initialDate","Date","savedSystemDate","localStorage","getItem","currentSystemDate","initialState","user","isAuthenticated","loading","error","systemDate","actionTypes","SET_LOADING","SET_USER","SET_ERROR","LOGOUT","SET_SYSTEM_DATE","appReducer","state","action","type","payload","AppProvider","_ref","children","dispatch","initAuth","token","savedUser","response","verify","success","JSON","parse","removeItem","console","login","studentId","password","rememberMe","arguments","length","undefined","student","data","setItem","stringify","message","logout","forceChangePassword","newPassword","updatedUser","forcePasswordChange","changePassword","oldPassword","setSystemDate","date","toISOString","advanceDay","currentDate","nextDay","setDate","getDate","log","toLocaleDateString","processMidnightTasks","resetToInitialDate","canSetDate","targetDate","today","setHours","target","setSystemDateSafely","processDate","dateStr","split","warn","fetch","method","headers","body","ok","result","json","errorText","text","status","value","Provider","useApp","context","Error"],"sources":["/Users/danieldong/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI } from '../services/api';\n\nconst AppContext = createContext();\n\n// ÂàùÂßãÁä∂ÊÄÅ\nconst initialDate = new Date();\nconst savedSystemDate = localStorage.getItem('systemDate');\nconst currentSystemDate = savedSystemDate ? new Date(savedSystemDate) : new Date(initialDate);\n\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: currentSystemDate,\n  initialDate: new Date(initialDate)\n};\n\n// ActionÁ±ªÂûã\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return { ...state, loading: action.payload };\n    \n    case actionTypes.SET_USER:\n      return { \n        ...state, \n        user: action.payload, \n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    \n    case actionTypes.SET_ERROR:\n      return { ...state, error: action.payload, loading: false };\n    \n    case actionTypes.LOGOUT:\n      return { \n        ...state, \n        user: null, \n        isAuthenticated: false, \n        loading: false \n      };\n    \n    case actionTypes.SET_SYSTEM_DATE:\n      return { ...state, systemDate: action.payload };\n    \n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // ÂàùÂßãÂåñÊó∂Ê£ÄÊü•token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      \n      if (token && savedUser) {\n        try {\n          // È™åËØÅtokenÊòØÂê¶ÊúâÊïà\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({ \n              type: actionTypes.SET_USER, \n              payload: JSON.parse(savedUser) \n            });\n          } else {\n            // tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({ type: actionTypes.LOGOUT });\n          }\n        } catch (error) {\n          console.error('TokenÈ™åËØÅÂ§±Ë¥•:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({ type: actionTypes.LOGOUT });\n        }\n      } else {\n        dispatch({ type: actionTypes.SET_LOADING, payload: false });\n      }\n    };\n\n    initAuth();\n  }, []);\n\n  // ÁôªÂΩï\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      dispatch({ type: actionTypes.SET_LOADING, payload: true });\n      dispatch({ type: actionTypes.SET_ERROR, payload: null });\n\n      const response = await authAPI.login(studentId, password);\n      \n      if (response.success) {\n        const { token, student } = response.data;\n        \n        // ‰øùÂ≠òÂà∞localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(student));\n        \n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({ \n            studentId, \n            password \n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n\n        dispatch({ type: actionTypes.SET_USER, payload: student });\n        return { success: true };\n      }\n    } catch (error) {\n      dispatch({ type: actionTypes.SET_ERROR, payload: error.message });\n      return { success: false, message: error.message };\n    }\n  };\n\n  // ÁôªÂá∫\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({ type: actionTypes.LOGOUT });\n  };\n\n  // Âº∫Âà∂‰øÆÊîπÂØÜÁ†Å\n  const forceChangePassword = async (newPassword) => {\n    try {\n      const response = await authAPI.forceChangePassword(newPassword);\n      if (response.success) {\n        // Êõ¥Êñ∞Áî®Êà∑Áä∂ÊÄÅ\n        const updatedUser = { ...state.user, forcePasswordChange: false };\n        localStorage.setItem('user', JSON.stringify(updatedUser));\n        dispatch({ type: actionTypes.SET_USER, payload: updatedUser });\n        return { success: true };\n      }\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // ‰øÆÊîπÂØÜÁ†Å\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÁî®‰∫éÊ®°ÊãüÔºâ\n  const setSystemDate = (date) => {\n    localStorage.setItem('systemDate', date.toISOString());\n    dispatch({ type: actionTypes.SET_SYSTEM_DATE, payload: date });\n  };\n\n  // ËøõÂÖ•‰∏ã‰∏ÄÂ§©ÔºàÊ®°ÊãüÂäüËÉΩÔºâ\n  const advanceDay = async () => {\n    try {\n      const currentDate = new Date(state.systemDate);\n      const nextDay = new Date(currentDate);\n      nextDay.setDate(nextDay.getDate() + 1);\n      \n      console.log(`üìÖ ‰ªé ${currentDate.toLocaleDateString('zh-CN')} ÂâçËøõÂà∞ ${nextDay.toLocaleDateString('zh-CN')}`);\n      \n      // Âú®ÂàáÊç¢Âà∞‰∏ã‰∏ÄÂ§©‰πãÂâçÔºåÂÖàÂ§ÑÁêÜÂΩìÂ§©ÁöÑÊú™ÂÆåÊàê‰ªªÂä°\n      await processMidnightTasks(currentDate);\n      \n      // ËÆæÁΩÆÊñ∞Êó•Êúü\n      setSystemDate(nextDay);\n      \n      console.log(`‚úÖ Êó•ÊúüÂàáÊç¢ÂÆåÊàê: ${nextDay.toLocaleDateString('zh-CN')}`);\n    } catch (error) {\n      console.error('‚ùå advanceDay Â§±Ë¥•:', error);\n      throw error; // ÈáçÊñ∞ÊäõÂá∫ÈîôËØØÔºåËÆ©Ë∞ÉÁî®ËÄÖÁü•ÈÅìÂ§±Ë¥•‰∫Ü\n    }\n  };\n\n  // ÈáçÁΩÆÂà∞ÂàùÂßãÊó•Êúü\n  const resetToInitialDate = () => {\n    localStorage.removeItem('systemDate');\n    setSystemDate(new Date(state.initialDate));\n  };\n\n  // Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ËÆæÁΩÆÊó•ÊúüÔºàÂè™ËÉΩËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•ÁöÑÊó•ÊúüÔºâ\n  const canSetDate = (targetDate) => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // ÂÆâÂÖ®ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÂè™ÂÖÅËÆ∏ËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•Êó•ÊúüÔºâ\n  const setSystemDateSafely = async (date) => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n      \n      // Â¶ÇÊûúÊòØË∑≥Ë∑ÉÂà∞Êú™Êù•Êó•ÊúüÔºåÈúÄË¶ÅÂ§ÑÁêÜ‰∏≠Èó¥ÊâÄÊúâÊó•ÊúüÁöÑ24:00‰ªªÂä°\n      if (targetDate > currentDate) {\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n      \n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // Â§ÑÁêÜ24:00‰ªªÂä°ÔºàËá™Âä®Ë∞ÉÁî®Ôºâ\n  const processMidnightTasks = async (targetDate) => {\n    try {\n      // Âè™ÊúâÂú®Áî®Êà∑Â∑≤ÁôªÂΩïÁöÑÊÉÖÂÜµ‰∏ãÊâçÂ§ÑÁêÜ\n      if (!state.user) {\n        console.log('Áî®Êà∑Êú™ÁôªÂΩïÔºåË∑≥Ëøá24:00‰ªªÂä°Â§ÑÁêÜ');\n        return;\n      }\n\n      const dateStr = targetDate.toISOString().split('T')[0];\n      console.log(`üïõ Ëá™Âä®Â§ÑÁêÜ ${dateStr} ÁöÑ24:00‰ªªÂä°...`);\n\n      const token = localStorage.getItem('token');\n      if (!token) {\n        console.warn('Êú™ÊâæÂà∞ËÆ§ËØÅ‰ª§ÁâåÔºåË∑≥Ëøá24:00‰ªªÂä°Â§ÑÁêÜ');\n        return;\n      }\n\n      const response = await fetch('/api/tasks/midnight-process', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          date: dateStr\n        })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        if (result.success) {\n          console.log(`‚úÖ 24:00‰ªªÂä°Â§ÑÁêÜÂÆåÊàê:`, result.data);\n        } else {\n          console.warn('‚ö†Ô∏è 24:00‰ªªÂä°Â§ÑÁêÜË≠¶Âëä:', result.message);\n        }\n      } else {\n        const errorText = await response.text();\n        console.error(`‚ùå 24:00‰ªªÂä°Â§ÑÁêÜHTTPÈîôËØØ ${response.status}:`, errorText);\n      }\n    } catch (error) {\n      console.error('‚ùå Ëá™Âä®24:00Â§ÑÁêÜÂ§±Ë¥•:', error);\n      // ‰∏çÊäõÂá∫ÈîôËØØÔºåÈÅøÂÖçÂΩ±ÂìçÊó•ÊúüÂàáÊç¢\n    }\n  };\n\n  const value = {\n    ...state,\n    login,\n    logout,\n    forceChangePassword,\n    changePassword,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n\n  return (\n    <AppContext.Provider value={value}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\n// Hook for using context\nexport const useApp = () => {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n\nexport default AppContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}