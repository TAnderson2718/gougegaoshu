{"ast":null,"code":"var _jsxFileName = \"/Users/danieldong/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI, taskAPI } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppContext = /*#__PURE__*/createContext();\n\n// 初始状态\nconst initialDate = new Date();\nconst savedSystemDate = localStorage.getItem('systemDate');\nconst currentSystemDate = savedSystemDate ? new Date(savedSystemDate) : new Date(initialDate);\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: currentSystemDate,\n  initialDate: new Date(initialDate)\n};\n\n// Action类型\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return {\n        ...state,\n        loading: action.payload\n      };\n    case actionTypes.SET_USER:\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    case actionTypes.SET_ERROR:\n      return {\n        ...state,\n        error: action.payload,\n        loading: false\n      };\n    case actionTypes.LOGOUT:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        loading: false\n      };\n    case actionTypes.SET_SYSTEM_DATE:\n      return {\n        ...state,\n        systemDate: action.payload\n      };\n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // 初始化时检查token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      if (token && savedUser) {\n        try {\n          // 验证token是否有效\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({\n              type: actionTypes.SET_USER,\n              payload: JSON.parse(savedUser)\n            });\n          } else {\n            // token无效，清除本地存储\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({\n              type: actionTypes.LOGOUT\n            });\n          }\n        } catch (error) {\n          console.error('Token验证失败:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({\n            type: actionTypes.LOGOUT\n          });\n        }\n      } else {\n        dispatch({\n          type: actionTypes.SET_LOADING,\n          payload: false\n        });\n      }\n    };\n    initAuth();\n  }, []);\n\n  // 登录\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      console.log(`🔐 AppContext login 开始: ${studentId}`);\n      dispatch({\n        type: actionTypes.SET_LOADING,\n        payload: true\n      });\n      dispatch({\n        type: actionTypes.SET_ERROR,\n        payload: null\n      });\n      const response = await authAPI.login(studentId, password);\n      console.log(`📨 API 响应:`, response);\n      if (response.success) {\n        const {\n          token,\n          student\n        } = response.data;\n        console.log(`👤 学生信息:`, student);\n\n        // 保存到localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(student));\n        console.log(`💾 用户信息已保存到 localStorage`);\n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({\n            studentId,\n            password\n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n        dispatch({\n          type: actionTypes.SET_USER,\n          payload: student\n        });\n        console.log(`✅ 登录成功，用户状态已更新: ${student.studentId}`);\n        return {\n          success: true\n        };\n      } else {\n        console.error(`❌ API 返回登录失败: ${response.message}`);\n        return {\n          success: false,\n          message: response.message\n        };\n      }\n    } catch (error) {\n      console.error(`❌ 登录异常:`, error);\n      dispatch({\n        type: actionTypes.SET_ERROR,\n        payload: error.message\n      });\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // 登出\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({\n      type: actionTypes.LOGOUT\n    });\n  };\n\n  // 强制修改密码\n  const forceChangePassword = async newPassword => {\n    try {\n      const response = await authAPI.forceChangePassword(newPassword);\n      if (response.success) {\n        // 更新用户状态\n        const updatedUser = {\n          ...state.user,\n          forcePasswordChange: false\n        };\n        localStorage.setItem('user', JSON.stringify(updatedUser));\n        dispatch({\n          type: actionTypes.SET_USER,\n          payload: updatedUser\n        });\n        return {\n          success: true\n        };\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // 修改密码\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // 刷新认证状态\n  const refreshAuth = async () => {\n    const token = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n    if (token && savedUser) {\n      try {\n        // 验证token是否有效\n        const response = await authAPI.verify();\n        if (response.success) {\n          dispatch({\n            type: actionTypes.SET_USER,\n            payload: JSON.parse(savedUser)\n          });\n          return true;\n        } else {\n          // token无效，清除本地存储\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({\n            type: actionTypes.LOGOUT\n          });\n          return false;\n        }\n      } catch (error) {\n        console.error('Token验证失败:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        dispatch({\n          type: actionTypes.LOGOUT\n        });\n        return false;\n      }\n    } else {\n      dispatch({\n        type: actionTypes.SET_LOADING,\n        payload: false\n      });\n      return false;\n    }\n  };\n\n  // 设置系统日期（用于模拟）\n  const setSystemDate = date => {\n    localStorage.setItem('systemDate', date.toISOString());\n    dispatch({\n      type: actionTypes.SET_SYSTEM_DATE,\n      payload: date\n    });\n  };\n\n  // 进入下一天（模拟功能）\n  const advanceDay = async () => {\n    try {\n      const currentDate = new Date(state.systemDate);\n      const nextDay = new Date(currentDate);\n      nextDay.setDate(nextDay.getDate() + 1);\n      console.log(`📅 从 ${currentDate.toLocaleDateString('zh-CN')} 前进到 ${nextDay.toLocaleDateString('zh-CN')}`);\n\n      // 在切换到下一天之前，先处理当天的未完成任务\n      await processMidnightTasks(currentDate);\n\n      // 设置新日期\n      setSystemDate(nextDay);\n      console.log(`✅ 日期切换完成: ${nextDay.toLocaleDateString('zh-CN')}`);\n    } catch (error) {\n      console.error('❌ advanceDay 失败:', error);\n      throw error; // 重新抛出错误，让调用者知道失败了\n    }\n  };\n\n  // 重置到初始日期并清空所有任务数据\n  const resetToInitialDate = async () => {\n    try {\n      console.log('🔄 开始重置到初始状态...');\n\n      // 如果用户已登录，先清空任务数据\n      if (state.user) {\n        console.log('🗑️ 清空所有任务数据...');\n        const response = await taskAPI.resetToInitial();\n        if (response.success) {\n          console.log('✅ 任务数据清空成功:', response.data);\n        } else {\n          console.warn('⚠️ 任务数据清空失败:', response.message);\n        }\n      }\n\n      // 重置日期\n      console.log('📅 重置日期到初始状态...');\n      localStorage.removeItem('systemDate');\n      setSystemDate(new Date(state.initialDate));\n      console.log('✅ 重置完成！所有任务数据已清空，可重新导入任务');\n    } catch (error) {\n      console.error('❌ 重置失败:', error);\n      // 即使API调用失败，仍然重置日期\n      localStorage.removeItem('systemDate');\n      setSystemDate(new Date(state.initialDate));\n    }\n  };\n\n  // 检查是否可以设置日期（只能设置今天或未来的日期）\n  const canSetDate = targetDate => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // 安全设置系统日期（只允许设置今天或未来日期）\n  const setSystemDateSafely = async date => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n\n      // 如果是跳跃到未来日期，需要处理中间所有日期的24:00任务\n      if (targetDate > currentDate) {\n        console.log(`🔄 跳跃日期：从 ${currentDate.toLocaleDateString('zh-CN')} 到 ${targetDate.toLocaleDateString('zh-CN')}`);\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          console.log(`🕛 处理中间日期: ${processDate.toLocaleDateString('zh-CN')}`);\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // 处理24:00任务（自动调用）\n  const processMidnightTasks = async targetDate => {\n    try {\n      // 只有在用户已登录的情况下才处理\n      if (!state.user) {\n        console.log('用户未登录，跳过24:00任务处理');\n        return;\n      }\n      const dateStr = targetDate.toISOString().split('T')[0];\n      console.log(`🕛 自动处理 ${dateStr} 的24:00任务...`);\n      const response = await taskAPI.processMidnightTasks(dateStr);\n      if (response.success) {\n        console.log(`✅ 24:00任务处理完成:`, response.data);\n      } else {\n        console.warn('⚠️ 24:00任务处理警告:', response.message);\n      }\n    } catch (error) {\n      console.error('❌ 自动24:00处理失败:', error);\n      // 不抛出错误，避免影响日期切换\n    }\n  };\n  const value = {\n    ...state,\n    login,\n    logout,\n    forceChangePassword,\n    changePassword,\n    refreshAuth,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 342,\n    columnNumber: 5\n  }, this);\n};\n\n// Hook for using context\n_s(AppProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = AppProvider;\nexport const useApp = () => {\n  _s2();\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n_s2(useApp, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default AppContext;\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authAPI","taskAPI","jsxDEV","_jsxDEV","AppContext","initialDate","Date","savedSystemDate","localStorage","getItem","currentSystemDate","initialState","user","isAuthenticated","loading","error","systemDate","actionTypes","SET_LOADING","SET_USER","SET_ERROR","LOGOUT","SET_SYSTEM_DATE","appReducer","state","action","type","payload","AppProvider","children","_s","dispatch","initAuth","token","savedUser","response","verify","success","JSON","parse","removeItem","console","login","studentId","password","rememberMe","log","student","data","setItem","stringify","message","logout","forceChangePassword","newPassword","updatedUser","forcePasswordChange","changePassword","oldPassword","refreshAuth","setSystemDate","date","toISOString","advanceDay","currentDate","nextDay","setDate","getDate","toLocaleDateString","processMidnightTasks","resetToInitialDate","resetToInitial","warn","canSetDate","targetDate","today","setHours","target","setSystemDateSafely","processDate","dateStr","split","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useApp","_s2","context","Error","$RefreshReg$"],"sources":["/Users/danieldong/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI, taskAPI } from '../services/api';\n\nconst AppContext = createContext();\n\n// 初始状态\nconst initialDate = new Date();\nconst savedSystemDate = localStorage.getItem('systemDate');\nconst currentSystemDate = savedSystemDate ? new Date(savedSystemDate) : new Date(initialDate);\n\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: currentSystemDate,\n  initialDate: new Date(initialDate)\n};\n\n// Action类型\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return { ...state, loading: action.payload };\n    \n    case actionTypes.SET_USER:\n      return { \n        ...state, \n        user: action.payload, \n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    \n    case actionTypes.SET_ERROR:\n      return { ...state, error: action.payload, loading: false };\n    \n    case actionTypes.LOGOUT:\n      return { \n        ...state, \n        user: null, \n        isAuthenticated: false, \n        loading: false \n      };\n    \n    case actionTypes.SET_SYSTEM_DATE:\n      return { ...state, systemDate: action.payload };\n    \n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // 初始化时检查token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      \n      if (token && savedUser) {\n        try {\n          // 验证token是否有效\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({ \n              type: actionTypes.SET_USER, \n              payload: JSON.parse(savedUser) \n            });\n          } else {\n            // token无效，清除本地存储\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({ type: actionTypes.LOGOUT });\n          }\n        } catch (error) {\n          console.error('Token验证失败:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({ type: actionTypes.LOGOUT });\n        }\n      } else {\n        dispatch({ type: actionTypes.SET_LOADING, payload: false });\n      }\n    };\n\n    initAuth();\n  }, []);\n\n  // 登录\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      console.log(`🔐 AppContext login 开始: ${studentId}`);\n      dispatch({ type: actionTypes.SET_LOADING, payload: true });\n      dispatch({ type: actionTypes.SET_ERROR, payload: null });\n\n      const response = await authAPI.login(studentId, password);\n      console.log(`📨 API 响应:`, response);\n      \n      if (response.success) {\n        const { token, student } = response.data;\n        console.log(`👤 学生信息:`, student);\n        \n        // 保存到localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(student));\n        console.log(`💾 用户信息已保存到 localStorage`);\n        \n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({ \n            studentId, \n            password \n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n\n        dispatch({ type: actionTypes.SET_USER, payload: student });\n        console.log(`✅ 登录成功，用户状态已更新: ${student.studentId}`);\n        return { success: true };\n      } else {\n        console.error(`❌ API 返回登录失败: ${response.message}`);\n        return { success: false, message: response.message };\n      }\n    } catch (error) {\n      console.error(`❌ 登录异常:`, error);\n      dispatch({ type: actionTypes.SET_ERROR, payload: error.message });\n      return { success: false, message: error.message };\n    }\n  };\n\n  // 登出\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({ type: actionTypes.LOGOUT });\n  };\n\n  // 强制修改密码\n  const forceChangePassword = async (newPassword) => {\n    try {\n      const response = await authAPI.forceChangePassword(newPassword);\n      if (response.success) {\n        // 更新用户状态\n        const updatedUser = { ...state.user, forcePasswordChange: false };\n        localStorage.setItem('user', JSON.stringify(updatedUser));\n        dispatch({ type: actionTypes.SET_USER, payload: updatedUser });\n        return { success: true };\n      }\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // 修改密码\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // 刷新认证状态\n  const refreshAuth = async () => {\n    const token = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n\n    if (token && savedUser) {\n      try {\n        // 验证token是否有效\n        const response = await authAPI.verify();\n        if (response.success) {\n          dispatch({\n            type: actionTypes.SET_USER,\n            payload: JSON.parse(savedUser)\n          });\n          return true;\n        } else {\n          // token无效，清除本地存储\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({ type: actionTypes.LOGOUT });\n          return false;\n        }\n      } catch (error) {\n        console.error('Token验证失败:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        dispatch({ type: actionTypes.LOGOUT });\n        return false;\n      }\n    } else {\n      dispatch({ type: actionTypes.SET_LOADING, payload: false });\n      return false;\n    }\n  };\n\n  // 设置系统日期（用于模拟）\n  const setSystemDate = (date) => {\n    localStorage.setItem('systemDate', date.toISOString());\n    dispatch({ type: actionTypes.SET_SYSTEM_DATE, payload: date });\n  };\n\n  // 进入下一天（模拟功能）\n  const advanceDay = async () => {\n    try {\n      const currentDate = new Date(state.systemDate);\n      const nextDay = new Date(currentDate);\n      nextDay.setDate(nextDay.getDate() + 1);\n\n      console.log(`📅 从 ${currentDate.toLocaleDateString('zh-CN')} 前进到 ${nextDay.toLocaleDateString('zh-CN')}`);\n\n      // 在切换到下一天之前，先处理当天的未完成任务\n      await processMidnightTasks(currentDate);\n\n      // 设置新日期\n      setSystemDate(nextDay);\n\n      console.log(`✅ 日期切换完成: ${nextDay.toLocaleDateString('zh-CN')}`);\n    } catch (error) {\n      console.error('❌ advanceDay 失败:', error);\n      throw error; // 重新抛出错误，让调用者知道失败了\n    }\n  };\n\n  // 重置到初始日期并清空所有任务数据\n  const resetToInitialDate = async () => {\n    try {\n      console.log('🔄 开始重置到初始状态...');\n\n      // 如果用户已登录，先清空任务数据\n      if (state.user) {\n        console.log('🗑️ 清空所有任务数据...');\n        const response = await taskAPI.resetToInitial();\n        if (response.success) {\n          console.log('✅ 任务数据清空成功:', response.data);\n        } else {\n          console.warn('⚠️ 任务数据清空失败:', response.message);\n        }\n      }\n\n      // 重置日期\n      console.log('📅 重置日期到初始状态...');\n      localStorage.removeItem('systemDate');\n      setSystemDate(new Date(state.initialDate));\n\n      console.log('✅ 重置完成！所有任务数据已清空，可重新导入任务');\n    } catch (error) {\n      console.error('❌ 重置失败:', error);\n      // 即使API调用失败，仍然重置日期\n      localStorage.removeItem('systemDate');\n      setSystemDate(new Date(state.initialDate));\n    }\n  };\n\n  // 检查是否可以设置日期（只能设置今天或未来的日期）\n  const canSetDate = (targetDate) => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // 安全设置系统日期（只允许设置今天或未来日期）\n  const setSystemDateSafely = async (date) => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n\n      // 如果是跳跃到未来日期，需要处理中间所有日期的24:00任务\n      if (targetDate > currentDate) {\n        console.log(`🔄 跳跃日期：从 ${currentDate.toLocaleDateString('zh-CN')} 到 ${targetDate.toLocaleDateString('zh-CN')}`);\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          console.log(`🕛 处理中间日期: ${processDate.toLocaleDateString('zh-CN')}`);\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n\n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // 处理24:00任务（自动调用）\n  const processMidnightTasks = async (targetDate) => {\n    try {\n      // 只有在用户已登录的情况下才处理\n      if (!state.user) {\n        console.log('用户未登录，跳过24:00任务处理');\n        return;\n      }\n\n      const dateStr = targetDate.toISOString().split('T')[0];\n      console.log(`🕛 自动处理 ${dateStr} 的24:00任务...`);\n\n      const response = await taskAPI.processMidnightTasks(dateStr);\n      \n      if (response.success) {\n        console.log(`✅ 24:00任务处理完成:`, response.data);\n      } else {\n        console.warn('⚠️ 24:00任务处理警告:', response.message);\n      }\n    } catch (error) {\n      console.error('❌ 自动24:00处理失败:', error);\n      // 不抛出错误，避免影响日期切换\n    }\n  };\n\n  const value = {\n    ...state,\n    login,\n    logout,\n    forceChangePassword,\n    changePassword,\n    refreshAuth,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n\n  return (\n    <AppContext.Provider value={value}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\n// Hook for using context\nexport const useApp = () => {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n\nexport default AppContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}