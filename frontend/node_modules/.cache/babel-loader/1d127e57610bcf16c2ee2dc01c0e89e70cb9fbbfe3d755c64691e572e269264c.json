{"ast":null,"code":"var _jsxFileName = \"/Users/daniel/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI, taskAPI } from '../services/api';\nimport { performStudentReset } from '../utils/dataConsistency';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppContext = /*#__PURE__*/createContext();\n\n// ÂàùÂßãÁä∂ÊÄÅ\nconst initialDate = new Date();\nconst savedSystemDate = localStorage.getItem('systemDate');\nconst currentSystemDate = savedSystemDate ? new Date(savedSystemDate) : new Date(initialDate);\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: currentSystemDate,\n  initialDate: new Date(initialDate)\n};\n\n// ActionÁ±ªÂûã\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return {\n        ...state,\n        loading: action.payload\n      };\n    case actionTypes.SET_USER:\n      console.log('üîÑ Reducer SET_USER ÊâßË°å:', {\n        payload: action.payload,\n        isAuthenticated: !!action.payload\n      });\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    case actionTypes.SET_ERROR:\n      return {\n        ...state,\n        error: action.payload,\n        loading: false\n      };\n    case actionTypes.LOGOUT:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        loading: false\n      };\n    case actionTypes.SET_SYSTEM_DATE:\n      return {\n        ...state,\n        systemDate: action.payload\n      };\n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // ÂàùÂßãÂåñÊó∂Ê£ÄÊü•token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      if (token && savedUser) {\n        try {\n          // È™åËØÅtokenÊòØÂê¶ÊúâÊïà\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({\n              type: actionTypes.SET_USER,\n              payload: JSON.parse(savedUser)\n            });\n          } else {\n            // tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({\n              type: actionTypes.LOGOUT\n            });\n          }\n        } catch (error) {\n          console.error('TokenÈ™åËØÅÂ§±Ë¥•:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({\n            type: actionTypes.LOGOUT\n          });\n        }\n      } else {\n        dispatch({\n          type: actionTypes.SET_LOADING,\n          payload: false\n        });\n      }\n    };\n    initAuth();\n  }, []);\n\n  // ÁôªÂΩï\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      console.log(`üîê AppContext login ÂºÄÂßã: ${studentId}`);\n      dispatch({\n        type: actionTypes.SET_LOADING,\n        payload: true\n      });\n      dispatch({\n        type: actionTypes.SET_ERROR,\n        payload: null\n      });\n\n      // Âà§Êñ≠ÊòØÁÆ°ÁêÜÂëòËøòÊòØÂ≠¶ÁîüÁôªÂΩï\n      const isAdmin = studentId.toUpperCase().startsWith('ADMIN');\n      console.log(`üåê ‰ΩøÁî® authAPI Ë∞ÉÁî®${isAdmin ? 'ÁÆ°ÁêÜÂëò' : 'Â≠¶Áîü'}ÁôªÂΩïÊé•Âè£`);\n      const response = isAdmin ? await authAPI.adminLogin(studentId, password) : await authAPI.login(studentId, password);\n      console.log(`üì® API ÂìçÂ∫î:`, response);\n      if (response.success) {\n        // Ê†πÊçÆÁôªÂΩïÁ±ªÂûãËé∑ÂèñÁî®Êà∑‰ø°ÊÅØ\n        const userData = isAdmin ? response.data.admin : response.data.student;\n        const {\n          token\n        } = response.data;\n        console.log(`üë§ Áî®Êà∑‰ø°ÊÅØ:`, userData);\n        console.log(`üîë Token:`, token);\n\n        // ‰øùÂ≠òÂà∞localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(userData));\n        console.log(`üíæ Áî®Êà∑‰ø°ÊÅØÂ∑≤‰øùÂ≠òÂà∞ localStorage`);\n        console.log(`üíæ localStorage token:`, localStorage.getItem('token'));\n        console.log(`üíæ localStorage user:`, localStorage.getItem('user'));\n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({\n            studentId,\n            password\n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n        dispatch({\n          type: actionTypes.SET_USER,\n          payload: userData\n        });\n        console.log(`‚úÖ ÁôªÂΩïÊàêÂäüÔºåÁî®Êà∑Áä∂ÊÄÅÂ∑≤Êõ¥Êñ∞: ${userData.id}`);\n        console.log(`üîÑ Dispatch SET_USER ÂÆåÊàê`);\n        console.log(`üîç Áî®Êà∑Êï∞ÊçÆ:`, userData);\n        console.log(`üîç Âç≥Â∞ÜËøîÂõûÁôªÂΩïÁªìÊûú...`);\n        return {\n          success: true,\n          user: userData\n        };\n      } else {\n        console.error(`‚ùå API ËøîÂõûÁôªÂΩïÂ§±Ë¥•: ${response.message}`);\n        return {\n          success: false,\n          message: response.message\n        };\n      }\n    } catch (error) {\n      console.error(`‚ùå ÁôªÂΩïÂºÇÂ∏∏:`, error);\n      dispatch({\n        type: actionTypes.SET_ERROR,\n        payload: error.message\n      });\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // ÁôªÂá∫\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({\n      type: actionTypes.LOGOUT\n    });\n  };\n\n  // ‰øÆÊîπÂØÜÁ†Å\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // Âà∑Êñ∞ËÆ§ËØÅÁä∂ÊÄÅ\n  const refreshAuth = async () => {\n    const token = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n    if (token && savedUser) {\n      try {\n        // È™åËØÅtokenÊòØÂê¶ÊúâÊïà\n        const response = await authAPI.verify();\n        if (response.success) {\n          dispatch({\n            type: actionTypes.SET_USER,\n            payload: JSON.parse(savedUser)\n          });\n          return true;\n        } else {\n          // tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({\n            type: actionTypes.LOGOUT\n          });\n          return false;\n        }\n      } catch (error) {\n        console.error('TokenÈ™åËØÅÂ§±Ë¥•:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        dispatch({\n          type: actionTypes.LOGOUT\n        });\n        return false;\n      }\n    } else {\n      dispatch({\n        type: actionTypes.SET_LOADING,\n        payload: false\n      });\n      return false;\n    }\n  };\n\n  // ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÁî®‰∫éÊ®°ÊãüÔºâ\n  const setSystemDate = date => {\n    localStorage.setItem('systemDate', date.toISOString());\n    dispatch({\n      type: actionTypes.SET_SYSTEM_DATE,\n      payload: date\n    });\n  };\n\n  // ËøõÂÖ•‰∏ã‰∏ÄÂ§©ÔºàÊ®°ÊãüÂäüËÉΩÔºâ\n  const advanceDay = async () => {\n    try {\n      const currentDate = new Date(state.systemDate);\n      const nextDay = new Date(currentDate);\n      nextDay.setDate(nextDay.getDate() + 1);\n      console.log(`üìÖ ‰ªé ${currentDate.toLocaleDateString('zh-CN')} ÂâçËøõÂà∞ ${nextDay.toLocaleDateString('zh-CN')}`);\n\n      // Âú®ÂàáÊç¢Âà∞‰∏ã‰∏ÄÂ§©‰πãÂâçÔºåÂÖàÂ§ÑÁêÜÂΩìÂ§©ÁöÑÊú™ÂÆåÊàê‰ªªÂä°\n      await processMidnightTasks(currentDate);\n\n      // ËÆæÁΩÆÊñ∞Êó•Êúü\n      setSystemDate(nextDay);\n      console.log(`‚úÖ Êó•ÊúüÂàáÊç¢ÂÆåÊàê: ${nextDay.toLocaleDateString('zh-CN')}`);\n    } catch (error) {\n      console.error('‚ùå advanceDay Â§±Ë¥•:', error);\n      throw error; // ÈáçÊñ∞ÊäõÂá∫ÈîôËØØÔºåËÆ©Ë∞ÉÁî®ËÄÖÁü•ÈÅìÂ§±Ë¥•‰∫Ü\n    }\n  };\n\n  // ÈáçÁΩÆÂà∞ÂàùÂßãÊó•ÊúüÂπ∂Ê∏ÖÁ©∫ÊâÄÊúâ‰ªªÂä°Êï∞ÊçÆ\n  const resetToInitialDate = async () => {\n    // Âè™ÊúâÁî®Êà∑Â∑≤ÁôªÂΩïÊâçËÉΩÈáçÁΩÆ\n    if (!state.user) {\n      console.warn('‚ö†Ô∏è Áî®Êà∑Êú™ÁôªÂΩïÔºåÊó†Ê≥ïÊâßË°åÈáçÁΩÆÊìç‰Ωú');\n      return;\n    }\n\n    // ‰ΩøÁî®‰∏ìÁî®ÁöÑÂ≠¶ÁîüÈáçÁΩÆÂ∑•ÂÖ∑\n    const result = await performStudentReset(taskAPI.resetToInitial, setSystemDate, state.initialDate);\n    if (result.success) {\n      console.log('‚úÖ Â≠¶ÁîüÁ´ØÈáçÁΩÆÊàêÂäü:', result.data);\n    } else if (!result.cancelled) {\n      console.error('‚ùå Â≠¶ÁîüÁ´ØÈáçÁΩÆÂ§±Ë¥•:', result.error);\n      alert('ÈáçÁΩÆÂ§±Ë¥•: ' + result.error);\n    }\n  };\n\n  // Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ËÆæÁΩÆÊó•ÊúüÔºàÂè™ËÉΩËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•ÁöÑÊó•ÊúüÔºâ\n  const canSetDate = targetDate => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // ÂÆâÂÖ®ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÂè™ÂÖÅËÆ∏ËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•Êó•ÊúüÔºâ\n  const setSystemDateSafely = async date => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n\n      // Â¶ÇÊûúÊòØË∑≥Ë∑ÉÂà∞Êú™Êù•Êó•ÊúüÔºåÈúÄË¶ÅÂ§ÑÁêÜ‰∏≠Èó¥ÊâÄÊúâÊó•ÊúüÁöÑ24:00‰ªªÂä°\n      if (targetDate > currentDate) {\n        console.log(`üîÑ Ë∑≥Ë∑ÉÊó•ÊúüÔºö‰ªé ${currentDate.toLocaleDateString('zh-CN')} Âà∞ ${targetDate.toLocaleDateString('zh-CN')}`);\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          console.log(`üïõ Â§ÑÁêÜ‰∏≠Èó¥Êó•Êúü: ${processDate.toLocaleDateString('zh-CN')}`);\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // Â§ÑÁêÜ24:00‰ªªÂä°ÔºàËá™Âä®Ë∞ÉÁî®Ôºâ\n  const processMidnightTasks = async targetDate => {\n    try {\n      // Âè™ÊúâÂú®Áî®Êà∑Â∑≤ÁôªÂΩïÁöÑÊÉÖÂÜµ‰∏ãÊâçÂ§ÑÁêÜ\n      if (!state.user) {\n        console.log('Áî®Êà∑Êú™ÁôªÂΩïÔºåË∑≥Ëøá24:00‰ªªÂä°Â§ÑÁêÜ');\n        return;\n      }\n      const dateStr = targetDate.toISOString().split('T')[0];\n\n      // Ê£ÄÊü•ÊòØÂê¶Ê≠£Âú®Â§ÑÁêÜ‰∏≠ÔºàÈò≤ÈáçÂ§çË∞ÉÁî®Ôºâ\n      const processingKey = `processing_midnight_${dateStr}`;\n      if (window[processingKey]) {\n        console.log(`‚è≠Ô∏è ${dateStr} ÁöÑ24:00‰ªªÂä°Ê≠£Âú®Â§ÑÁêÜ‰∏≠ÔºåË∑≥ËøáÈáçÂ§çË∞ÉÁî®`);\n        return;\n      }\n\n      // ËÆæÁΩÆÂ§ÑÁêÜÊ†áÂøó\n      window[processingKey] = true;\n      try {\n        console.log(`üïõ Ëá™Âä®Â§ÑÁêÜ ${dateStr} ÁöÑ24:00‰ªªÂä°...`);\n        const response = await taskAPI.processMidnightTasks(dateStr);\n        if (response.success) {\n          if (response.data.skipped) {\n            console.log(`‚è≠Ô∏è 24:00‰ªªÂä°Â∑≤Â§ÑÁêÜËøá:`, response.data);\n          } else {\n            console.log(`‚úÖ 24:00‰ªªÂä°Â§ÑÁêÜÂÆåÊàê:`, response.data);\n          }\n        } else {\n          console.warn('‚ö†Ô∏è 24:00‰ªªÂä°Â§ÑÁêÜË≠¶Âëä:', response.message);\n        }\n      } finally {\n        // Ê∏ÖÈô§Â§ÑÁêÜÊ†áÂøó\n        delete window[processingKey];\n      }\n    } catch (error) {\n      console.error('‚ùå Ëá™Âä®24:00Â§ÑÁêÜÂ§±Ë¥•:', error);\n      // ‰∏çÊäõÂá∫ÈîôËØØÔºåÈÅøÂÖçÂΩ±ÂìçÊó•ÊúüÂàáÊç¢\n    }\n  };\n  const value = {\n    ...state,\n    login,\n    logout,\n    changePassword,\n    refreshAuth,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 361,\n    columnNumber: 5\n  }, this);\n};\n\n// Hook for using context\n_s(AppProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = AppProvider;\nexport const useApp = () => {\n  _s2();\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n_s2(useApp, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default AppContext;\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authAPI","taskAPI","performStudentReset","jsxDEV","_jsxDEV","AppContext","initialDate","Date","savedSystemDate","localStorage","getItem","currentSystemDate","initialState","user","isAuthenticated","loading","error","systemDate","actionTypes","SET_LOADING","SET_USER","SET_ERROR","LOGOUT","SET_SYSTEM_DATE","appReducer","state","action","type","payload","console","log","AppProvider","children","_s","dispatch","initAuth","token","savedUser","response","verify","success","JSON","parse","removeItem","login","studentId","password","rememberMe","isAdmin","toUpperCase","startsWith","adminLogin","userData","data","admin","student","setItem","stringify","id","message","logout","changePassword","oldPassword","newPassword","refreshAuth","setSystemDate","date","toISOString","advanceDay","currentDate","nextDay","setDate","getDate","toLocaleDateString","processMidnightTasks","resetToInitialDate","warn","result","resetToInitial","cancelled","alert","canSetDate","targetDate","today","setHours","target","setSystemDateSafely","processDate","dateStr","split","processingKey","window","skipped","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useApp","_s2","context","Error","$RefreshReg$"],"sources":["/Users/daniel/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI, taskAPI } from '../services/api';\nimport { performStudentReset } from '../utils/dataConsistency';\n\nconst AppContext = createContext();\n\n// ÂàùÂßãÁä∂ÊÄÅ\nconst initialDate = new Date();\nconst savedSystemDate = localStorage.getItem('systemDate');\nconst currentSystemDate = savedSystemDate ? new Date(savedSystemDate) : new Date(initialDate);\n\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: currentSystemDate,\n  initialDate: new Date(initialDate)\n};\n\n// ActionÁ±ªÂûã\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return { ...state, loading: action.payload };\n    \n    case actionTypes.SET_USER:\n      console.log('üîÑ Reducer SET_USER ÊâßË°å:', {\n        payload: action.payload,\n        isAuthenticated: !!action.payload\n      });\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    \n    case actionTypes.SET_ERROR:\n      return { ...state, error: action.payload, loading: false };\n    \n    case actionTypes.LOGOUT:\n      return { \n        ...state, \n        user: null, \n        isAuthenticated: false, \n        loading: false \n      };\n    \n    case actionTypes.SET_SYSTEM_DATE:\n      return { ...state, systemDate: action.payload };\n    \n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // ÂàùÂßãÂåñÊó∂Ê£ÄÊü•token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      \n      if (token && savedUser) {\n        try {\n          // È™åËØÅtokenÊòØÂê¶ÊúâÊïà\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({ \n              type: actionTypes.SET_USER, \n              payload: JSON.parse(savedUser) \n            });\n          } else {\n            // tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({ type: actionTypes.LOGOUT });\n          }\n        } catch (error) {\n          console.error('TokenÈ™åËØÅÂ§±Ë¥•:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({ type: actionTypes.LOGOUT });\n        }\n      } else {\n        dispatch({ type: actionTypes.SET_LOADING, payload: false });\n      }\n    };\n\n    initAuth();\n  }, []);\n\n  // ÁôªÂΩï\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      console.log(`üîê AppContext login ÂºÄÂßã: ${studentId}`);\n      dispatch({ type: actionTypes.SET_LOADING, payload: true });\n      dispatch({ type: actionTypes.SET_ERROR, payload: null });\n\n      // Âà§Êñ≠ÊòØÁÆ°ÁêÜÂëòËøòÊòØÂ≠¶ÁîüÁôªÂΩï\n      const isAdmin = studentId.toUpperCase().startsWith('ADMIN');\n\n      console.log(`üåê ‰ΩøÁî® authAPI Ë∞ÉÁî®${isAdmin ? 'ÁÆ°ÁêÜÂëò' : 'Â≠¶Áîü'}ÁôªÂΩïÊé•Âè£`);\n      const response = isAdmin\n        ? await authAPI.adminLogin(studentId, password)\n        : await authAPI.login(studentId, password);\n\n      console.log(`üì® API ÂìçÂ∫î:`, response);\n\n      if (response.success) {\n        // Ê†πÊçÆÁôªÂΩïÁ±ªÂûãËé∑ÂèñÁî®Êà∑‰ø°ÊÅØ\n        const userData = isAdmin ? response.data.admin : response.data.student;\n        const { token } = response.data;\n\n        console.log(`üë§ Áî®Êà∑‰ø°ÊÅØ:`, userData);\n        console.log(`üîë Token:`, token);\n\n        // ‰øùÂ≠òÂà∞localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(userData));\n        console.log(`üíæ Áî®Êà∑‰ø°ÊÅØÂ∑≤‰øùÂ≠òÂà∞ localStorage`);\n        console.log(`üíæ localStorage token:`, localStorage.getItem('token'));\n        console.log(`üíæ localStorage user:`, localStorage.getItem('user'));\n\n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({\n            studentId,\n            password\n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n\n        dispatch({ type: actionTypes.SET_USER, payload: userData });\n        console.log(`‚úÖ ÁôªÂΩïÊàêÂäüÔºåÁî®Êà∑Áä∂ÊÄÅÂ∑≤Êõ¥Êñ∞: ${userData.id}`);\n        console.log(`üîÑ Dispatch SET_USER ÂÆåÊàê`);\n        console.log(`üîç Áî®Êà∑Êï∞ÊçÆ:`, userData);\n        console.log(`üîç Âç≥Â∞ÜËøîÂõûÁôªÂΩïÁªìÊûú...`);\n        return { success: true, user: userData };\n      } else {\n        console.error(`‚ùå API ËøîÂõûÁôªÂΩïÂ§±Ë¥•: ${response.message}`);\n        return { success: false, message: response.message };\n      }\n    } catch (error) {\n      console.error(`‚ùå ÁôªÂΩïÂºÇÂ∏∏:`, error);\n      dispatch({ type: actionTypes.SET_ERROR, payload: error.message });\n      return { success: false, message: error.message };\n    }\n  };\n\n  // ÁôªÂá∫\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({ type: actionTypes.LOGOUT });\n  };\n\n\n\n  // ‰øÆÊîπÂØÜÁ†Å\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // Âà∑Êñ∞ËÆ§ËØÅÁä∂ÊÄÅ\n  const refreshAuth = async () => {\n    const token = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n\n    if (token && savedUser) {\n      try {\n        // È™åËØÅtokenÊòØÂê¶ÊúâÊïà\n        const response = await authAPI.verify();\n        if (response.success) {\n          dispatch({\n            type: actionTypes.SET_USER,\n            payload: JSON.parse(savedUser)\n          });\n          return true;\n        } else {\n          // tokenÊó†ÊïàÔºåÊ∏ÖÈô§Êú¨Âú∞Â≠òÂÇ®\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({ type: actionTypes.LOGOUT });\n          return false;\n        }\n      } catch (error) {\n        console.error('TokenÈ™åËØÅÂ§±Ë¥•:', error);\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        dispatch({ type: actionTypes.LOGOUT });\n        return false;\n      }\n    } else {\n      dispatch({ type: actionTypes.SET_LOADING, payload: false });\n      return false;\n    }\n  };\n\n  // ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÁî®‰∫éÊ®°ÊãüÔºâ\n  const setSystemDate = (date) => {\n    localStorage.setItem('systemDate', date.toISOString());\n    dispatch({ type: actionTypes.SET_SYSTEM_DATE, payload: date });\n  };\n\n  // ËøõÂÖ•‰∏ã‰∏ÄÂ§©ÔºàÊ®°ÊãüÂäüËÉΩÔºâ\n  const advanceDay = async () => {\n    try {\n      const currentDate = new Date(state.systemDate);\n      const nextDay = new Date(currentDate);\n      nextDay.setDate(nextDay.getDate() + 1);\n\n      console.log(`üìÖ ‰ªé ${currentDate.toLocaleDateString('zh-CN')} ÂâçËøõÂà∞ ${nextDay.toLocaleDateString('zh-CN')}`);\n\n      // Âú®ÂàáÊç¢Âà∞‰∏ã‰∏ÄÂ§©‰πãÂâçÔºåÂÖàÂ§ÑÁêÜÂΩìÂ§©ÁöÑÊú™ÂÆåÊàê‰ªªÂä°\n      await processMidnightTasks(currentDate);\n\n      // ËÆæÁΩÆÊñ∞Êó•Êúü\n      setSystemDate(nextDay);\n\n      console.log(`‚úÖ Êó•ÊúüÂàáÊç¢ÂÆåÊàê: ${nextDay.toLocaleDateString('zh-CN')}`);\n    } catch (error) {\n      console.error('‚ùå advanceDay Â§±Ë¥•:', error);\n      throw error; // ÈáçÊñ∞ÊäõÂá∫ÈîôËØØÔºåËÆ©Ë∞ÉÁî®ËÄÖÁü•ÈÅìÂ§±Ë¥•‰∫Ü\n    }\n  };\n\n  // ÈáçÁΩÆÂà∞ÂàùÂßãÊó•ÊúüÂπ∂Ê∏ÖÁ©∫ÊâÄÊúâ‰ªªÂä°Êï∞ÊçÆ\n  const resetToInitialDate = async () => {\n    // Âè™ÊúâÁî®Êà∑Â∑≤ÁôªÂΩïÊâçËÉΩÈáçÁΩÆ\n    if (!state.user) {\n      console.warn('‚ö†Ô∏è Áî®Êà∑Êú™ÁôªÂΩïÔºåÊó†Ê≥ïÊâßË°åÈáçÁΩÆÊìç‰Ωú');\n      return;\n    }\n\n    // ‰ΩøÁî®‰∏ìÁî®ÁöÑÂ≠¶ÁîüÈáçÁΩÆÂ∑•ÂÖ∑\n    const result = await performStudentReset(\n      taskAPI.resetToInitial,\n      setSystemDate,\n      state.initialDate\n    );\n\n    if (result.success) {\n      console.log('‚úÖ Â≠¶ÁîüÁ´ØÈáçÁΩÆÊàêÂäü:', result.data);\n    } else if (!result.cancelled) {\n      console.error('‚ùå Â≠¶ÁîüÁ´ØÈáçÁΩÆÂ§±Ë¥•:', result.error);\n      alert('ÈáçÁΩÆÂ§±Ë¥•: ' + result.error);\n    }\n  };\n\n  // Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ËÆæÁΩÆÊó•ÊúüÔºàÂè™ËÉΩËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•ÁöÑÊó•ÊúüÔºâ\n  const canSetDate = (targetDate) => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // ÂÆâÂÖ®ËÆæÁΩÆÁ≥ªÁªüÊó•ÊúüÔºàÂè™ÂÖÅËÆ∏ËÆæÁΩÆ‰ªäÂ§©ÊàñÊú™Êù•Êó•ÊúüÔºâ\n  const setSystemDateSafely = async (date) => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n\n      // Â¶ÇÊûúÊòØË∑≥Ë∑ÉÂà∞Êú™Êù•Êó•ÊúüÔºåÈúÄË¶ÅÂ§ÑÁêÜ‰∏≠Èó¥ÊâÄÊúâÊó•ÊúüÁöÑ24:00‰ªªÂä°\n      if (targetDate > currentDate) {\n        console.log(`üîÑ Ë∑≥Ë∑ÉÊó•ÊúüÔºö‰ªé ${currentDate.toLocaleDateString('zh-CN')} Âà∞ ${targetDate.toLocaleDateString('zh-CN')}`);\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          console.log(`üïõ Â§ÑÁêÜ‰∏≠Èó¥Êó•Êúü: ${processDate.toLocaleDateString('zh-CN')}`);\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n\n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // Â§ÑÁêÜ24:00‰ªªÂä°ÔºàËá™Âä®Ë∞ÉÁî®Ôºâ\n  const processMidnightTasks = async (targetDate) => {\n    try {\n      // Âè™ÊúâÂú®Áî®Êà∑Â∑≤ÁôªÂΩïÁöÑÊÉÖÂÜµ‰∏ãÊâçÂ§ÑÁêÜ\n      if (!state.user) {\n        console.log('Áî®Êà∑Êú™ÁôªÂΩïÔºåË∑≥Ëøá24:00‰ªªÂä°Â§ÑÁêÜ');\n        return;\n      }\n\n      const dateStr = targetDate.toISOString().split('T')[0];\n\n      // Ê£ÄÊü•ÊòØÂê¶Ê≠£Âú®Â§ÑÁêÜ‰∏≠ÔºàÈò≤ÈáçÂ§çË∞ÉÁî®Ôºâ\n      const processingKey = `processing_midnight_${dateStr}`;\n      if (window[processingKey]) {\n        console.log(`‚è≠Ô∏è ${dateStr} ÁöÑ24:00‰ªªÂä°Ê≠£Âú®Â§ÑÁêÜ‰∏≠ÔºåË∑≥ËøáÈáçÂ§çË∞ÉÁî®`);\n        return;\n      }\n\n      // ËÆæÁΩÆÂ§ÑÁêÜÊ†áÂøó\n      window[processingKey] = true;\n\n      try {\n        console.log(`üïõ Ëá™Âä®Â§ÑÁêÜ ${dateStr} ÁöÑ24:00‰ªªÂä°...`);\n\n        const response = await taskAPI.processMidnightTasks(dateStr);\n\n        if (response.success) {\n          if (response.data.skipped) {\n            console.log(`‚è≠Ô∏è 24:00‰ªªÂä°Â∑≤Â§ÑÁêÜËøá:`, response.data);\n          } else {\n            console.log(`‚úÖ 24:00‰ªªÂä°Â§ÑÁêÜÂÆåÊàê:`, response.data);\n          }\n        } else {\n          console.warn('‚ö†Ô∏è 24:00‰ªªÂä°Â§ÑÁêÜË≠¶Âëä:', response.message);\n        }\n      } finally {\n        // Ê∏ÖÈô§Â§ÑÁêÜÊ†áÂøó\n        delete window[processingKey];\n      }\n    } catch (error) {\n      console.error('‚ùå Ëá™Âä®24:00Â§ÑÁêÜÂ§±Ë¥•:', error);\n      // ‰∏çÊäõÂá∫ÈîôËØØÔºåÈÅøÂÖçÂΩ±ÂìçÊó•ÊúüÂàáÊç¢\n    }\n  };\n\n  const value = {\n    ...state,\n    login,\n    logout,\n    changePassword,\n    refreshAuth,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n\n  return (\n    <AppContext.Provider value={value}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\n// Hook for using context\nexport const useApp = () => {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n\nexport default AppContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}