{"ast":null,"code":"var _jsxFileName = \"/Users/danieldong/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AppContext = /*#__PURE__*/createContext();\n\n// 初始状态\nconst initialDate = new Date();\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: new Date(initialDate),\n  initialDate: new Date(initialDate)\n};\n\n// Action类型\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return {\n        ...state,\n        loading: action.payload\n      };\n    case actionTypes.SET_USER:\n      return {\n        ...state,\n        user: action.payload,\n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    case actionTypes.SET_ERROR:\n      return {\n        ...state,\n        error: action.payload,\n        loading: false\n      };\n    case actionTypes.LOGOUT:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        loading: false\n      };\n    case actionTypes.SET_SYSTEM_DATE:\n      return {\n        ...state,\n        systemDate: action.payload\n      };\n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // 初始化时检查token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      if (token && savedUser) {\n        try {\n          // 验证token是否有效\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({\n              type: actionTypes.SET_USER,\n              payload: JSON.parse(savedUser)\n            });\n          } else {\n            // token无效，清除本地存储\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({\n              type: actionTypes.LOGOUT\n            });\n          }\n        } catch (error) {\n          console.error('Token验证失败:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({\n            type: actionTypes.LOGOUT\n          });\n        }\n      } else {\n        dispatch({\n          type: actionTypes.SET_LOADING,\n          payload: false\n        });\n      }\n    };\n    initAuth();\n  }, []);\n\n  // 登录\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      dispatch({\n        type: actionTypes.SET_LOADING,\n        payload: true\n      });\n      dispatch({\n        type: actionTypes.SET_ERROR,\n        payload: null\n      });\n      const response = await authAPI.login(studentId, password);\n      if (response.success) {\n        const {\n          token,\n          student\n        } = response.data;\n\n        // 保存到localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(student));\n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({\n            studentId,\n            password\n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n        dispatch({\n          type: actionTypes.SET_USER,\n          payload: student\n        });\n        return {\n          success: true\n        };\n      }\n    } catch (error) {\n      dispatch({\n        type: actionTypes.SET_ERROR,\n        payload: error.message\n      });\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // 登出\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({\n      type: actionTypes.LOGOUT\n    });\n  };\n\n  // 强制修改密码\n  const forceChangePassword = async newPassword => {\n    try {\n      const response = await authAPI.forceChangePassword(newPassword);\n      if (response.success) {\n        // 更新用户状态\n        const updatedUser = {\n          ...state.user,\n          forcePasswordChange: false\n        };\n        localStorage.setItem('user', JSON.stringify(updatedUser));\n        dispatch({\n          type: actionTypes.SET_USER,\n          payload: updatedUser\n        });\n        return {\n          success: true\n        };\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // 修改密码\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return {\n        success: false,\n        message: error.message\n      };\n    }\n  };\n\n  // 设置系统日期（用于模拟）\n  const setSystemDate = date => {\n    dispatch({\n      type: actionTypes.SET_SYSTEM_DATE,\n      payload: date\n    });\n  };\n\n  // 进入下一天（模拟功能）\n  const advanceDay = async () => {\n    const currentDate = new Date(state.systemDate);\n    const nextDay = new Date(currentDate);\n    nextDay.setDate(nextDay.getDate() + 1);\n\n    // 在切换到下一天之前，先处理当天的未完成任务\n    await processMidnightTasks(currentDate);\n    setSystemDate(nextDay);\n  };\n\n  // 重置到初始日期\n  const resetToInitialDate = () => {\n    setSystemDate(new Date(state.initialDate));\n  };\n\n  // 检查是否可以设置日期（只能设置今天或未来的日期）\n  const canSetDate = targetDate => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // 安全设置系统日期（只允许设置今天或未来日期）\n  const setSystemDateSafely = async date => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n\n      // 如果是跳跃到未来日期，需要处理中间所有日期的24:00任务\n      if (targetDate > currentDate) {\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // 处理24:00任务（自动调用）\n  const processMidnightTasks = async targetDate => {\n    try {\n      // 只有在用户已登录的情况下才处理\n      if (!state.user) return;\n      const dateStr = targetDate.toISOString().split('T')[0];\n      console.log(`自动处理 ${dateStr} 的24:00任务...`);\n      const response = await fetch('/api/tasks/midnight-process', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          date: dateStr\n        })\n      });\n      if (response.ok) {\n        const result = await response.json();\n        if (result.success) {\n          console.log(`24:00任务处理完成:`, result.data);\n        } else {\n          console.warn('24:00任务处理警告:', result.message);\n        }\n      }\n    } catch (error) {\n      console.error('自动24:00处理失败:', error);\n      // 不抛出错误，避免影响日期切换\n    }\n  };\n  const value = {\n    ...state,\n    login,\n    logout,\n    forceChangePassword,\n    changePassword,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 265,\n    columnNumber: 5\n  }, this);\n};\n\n// Hook for using context\n_s(AppProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = AppProvider;\nexport const useApp = () => {\n  _s2();\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n_s2(useApp, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default AppContext;\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authAPI","jsxDEV","_jsxDEV","AppContext","initialDate","Date","initialState","user","isAuthenticated","loading","error","systemDate","actionTypes","SET_LOADING","SET_USER","SET_ERROR","LOGOUT","SET_SYSTEM_DATE","appReducer","state","action","type","payload","AppProvider","children","_s","dispatch","initAuth","token","localStorage","getItem","savedUser","response","verify","success","JSON","parse","removeItem","console","login","studentId","password","rememberMe","student","data","setItem","stringify","message","logout","forceChangePassword","newPassword","updatedUser","forcePasswordChange","changePassword","oldPassword","setSystemDate","date","advanceDay","currentDate","nextDay","setDate","getDate","processMidnightTasks","resetToInitialDate","canSetDate","targetDate","today","setHours","target","setSystemDateSafely","processDate","dateStr","toISOString","split","log","fetch","method","headers","body","ok","result","json","warn","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useApp","_s2","context","Error","$RefreshReg$"],"sources":["/Users/danieldong/Documents/GitHub/gougegaoshu/frontend/src/contexts/AppContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI } from '../services/api';\n\nconst AppContext = createContext();\n\n// 初始状态\nconst initialDate = new Date();\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  loading: true,\n  error: null,\n  systemDate: new Date(initialDate),\n  initialDate: new Date(initialDate)\n};\n\n// Action类型\nconst actionTypes = {\n  SET_LOADING: 'SET_LOADING',\n  SET_USER: 'SET_USER',\n  SET_ERROR: 'SET_ERROR',\n  LOGOUT: 'LOGOUT',\n  SET_SYSTEM_DATE: 'SET_SYSTEM_DATE'\n};\n\n// Reducer\nfunction appReducer(state, action) {\n  switch (action.type) {\n    case actionTypes.SET_LOADING:\n      return { ...state, loading: action.payload };\n    \n    case actionTypes.SET_USER:\n      return { \n        ...state, \n        user: action.payload, \n        isAuthenticated: !!action.payload,\n        loading: false,\n        error: null\n      };\n    \n    case actionTypes.SET_ERROR:\n      return { ...state, error: action.payload, loading: false };\n    \n    case actionTypes.LOGOUT:\n      return { \n        ...state, \n        user: null, \n        isAuthenticated: false, \n        loading: false \n      };\n    \n    case actionTypes.SET_SYSTEM_DATE:\n      return { ...state, systemDate: action.payload };\n    \n    default:\n      return state;\n  }\n}\n\n// Context Provider\nexport const AppProvider = ({ children }) => {\n  const [state, dispatch] = useReducer(appReducer, initialState);\n\n  // 初始化时检查token\n  useEffect(() => {\n    const initAuth = async () => {\n      const token = localStorage.getItem('token');\n      const savedUser = localStorage.getItem('user');\n      \n      if (token && savedUser) {\n        try {\n          // 验证token是否有效\n          const response = await authAPI.verify();\n          if (response.success) {\n            dispatch({ \n              type: actionTypes.SET_USER, \n              payload: JSON.parse(savedUser) \n            });\n          } else {\n            // token无效，清除本地存储\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            dispatch({ type: actionTypes.LOGOUT });\n          }\n        } catch (error) {\n          console.error('Token验证失败:', error);\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          dispatch({ type: actionTypes.LOGOUT });\n        }\n      } else {\n        dispatch({ type: actionTypes.SET_LOADING, payload: false });\n      }\n    };\n\n    initAuth();\n  }, []);\n\n  // 登录\n  const login = async (studentId, password, rememberMe = false) => {\n    try {\n      dispatch({ type: actionTypes.SET_LOADING, payload: true });\n      dispatch({ type: actionTypes.SET_ERROR, payload: null });\n\n      const response = await authAPI.login(studentId, password);\n      \n      if (response.success) {\n        const { token, student } = response.data;\n        \n        // 保存到localStorage\n        localStorage.setItem('token', token);\n        localStorage.setItem('user', JSON.stringify(student));\n        \n        if (rememberMe) {\n          localStorage.setItem('savedCredentials', JSON.stringify({ \n            studentId, \n            password \n          }));\n        } else {\n          localStorage.removeItem('savedCredentials');\n        }\n\n        dispatch({ type: actionTypes.SET_USER, payload: student });\n        return { success: true };\n      }\n    } catch (error) {\n      dispatch({ type: actionTypes.SET_ERROR, payload: error.message });\n      return { success: false, message: error.message };\n    }\n  };\n\n  // 登出\n  const logout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    dispatch({ type: actionTypes.LOGOUT });\n  };\n\n  // 强制修改密码\n  const forceChangePassword = async (newPassword) => {\n    try {\n      const response = await authAPI.forceChangePassword(newPassword);\n      if (response.success) {\n        // 更新用户状态\n        const updatedUser = { ...state.user, forcePasswordChange: false };\n        localStorage.setItem('user', JSON.stringify(updatedUser));\n        dispatch({ type: actionTypes.SET_USER, payload: updatedUser });\n        return { success: true };\n      }\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // 修改密码\n  const changePassword = async (oldPassword, newPassword) => {\n    try {\n      const response = await authAPI.changePassword(oldPassword, newPassword);\n      return response;\n    } catch (error) {\n      return { success: false, message: error.message };\n    }\n  };\n\n  // 设置系统日期（用于模拟）\n  const setSystemDate = (date) => {\n    dispatch({ type: actionTypes.SET_SYSTEM_DATE, payload: date });\n  };\n\n  // 进入下一天（模拟功能）\n  const advanceDay = async () => {\n    const currentDate = new Date(state.systemDate);\n    const nextDay = new Date(currentDate);\n    nextDay.setDate(nextDay.getDate() + 1);\n    \n    // 在切换到下一天之前，先处理当天的未完成任务\n    await processMidnightTasks(currentDate);\n    \n    setSystemDate(nextDay);\n  };\n\n  // 重置到初始日期\n  const resetToInitialDate = () => {\n    setSystemDate(new Date(state.initialDate));\n  };\n\n  // 检查是否可以设置日期（只能设置今天或未来的日期）\n  const canSetDate = (targetDate) => {\n    const today = new Date(state.initialDate);\n    today.setHours(0, 0, 0, 0);\n    const target = new Date(targetDate);\n    target.setHours(0, 0, 0, 0);\n    return target >= today;\n  };\n\n  // 安全设置系统日期（只允许设置今天或未来日期）\n  const setSystemDateSafely = async (date) => {\n    if (canSetDate(date)) {\n      const currentDate = new Date(state.systemDate);\n      const targetDate = new Date(date);\n      \n      // 如果是跳跃到未来日期，需要处理中间所有日期的24:00任务\n      if (targetDate > currentDate) {\n        let processDate = new Date(currentDate);\n        while (processDate < targetDate) {\n          await processMidnightTasks(processDate);\n          processDate.setDate(processDate.getDate() + 1);\n        }\n      }\n      \n      setSystemDate(date);\n      return true;\n    }\n    return false;\n  };\n\n  // 处理24:00任务（自动调用）\n  const processMidnightTasks = async (targetDate) => {\n    try {\n      // 只有在用户已登录的情况下才处理\n      if (!state.user) return;\n\n      const dateStr = targetDate.toISOString().split('T')[0];\n      console.log(`自动处理 ${dateStr} 的24:00任务...`);\n\n      const response = await fetch('/api/tasks/midnight-process', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        },\n        body: JSON.stringify({\n          date: dateStr\n        })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        if (result.success) {\n          console.log(`24:00任务处理完成:`, result.data);\n        } else {\n          console.warn('24:00任务处理警告:', result.message);\n        }\n      }\n    } catch (error) {\n      console.error('自动24:00处理失败:', error);\n      // 不抛出错误，避免影响日期切换\n    }\n  };\n\n  const value = {\n    ...state,\n    login,\n    logout,\n    forceChangePassword,\n    changePassword,\n    setSystemDate,\n    setSystemDateSafely,\n    advanceDay,\n    resetToInitialDate,\n    canSetDate\n  };\n\n  return (\n    <AppContext.Provider value={value}>\n      {children}\n    </AppContext.Provider>\n  );\n};\n\n// Hook for using context\nexport const useApp = () => {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error('useApp must be used within an AppProvider');\n  }\n  return context;\n};\n\nexport default AppContext;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}